<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Simple Video Call</title>
  <script defer src="script.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-900 text-white flex flex-col items-center justify-center min-h-screen space-y-6 p-4">
  <h1 class="text-2xl font-bold">üßë‚Äçüíª Simple Video Call</h1>

  <div class="flex space-x-4">
    <div>
      <p class="text-center">üì∑ Local Video</p>
      <video id="localVideo" autoplay playsinline class="w-64 h-48 bg-black rounded-lg"></video>
    </div>
    <div>
      <p class="text-center">üåç Remote Video</p>
      <video id="remoteVideo" autoplay playsinline class="w-64 h-48 bg-black rounded-lg"></video>
    </div>
  </div>

  <div class="space-x-4">
    <button id="startBtn" class="bg-green-600 px-6 py-2 rounded font-bold">Start Call</button>
    <button id="hangupBtn" class="bg-red-600 px-6 py-2 rounded font-bold">Hang Up</button>
  </div>

  <script>
    const localVideo = document.getElementById('localVideo');
    const remoteVideo = document.getElementById('remoteVideo');
    const startBtn = document.getElementById('startBtn');
    const hangupBtn = document.getElementById('hangupBtn');

    let localStream;
    let pc1, pc2;

    const config = {
      iceServers: [{ urls: 'stun:stun.l.google.com:19302' }]
    };

    async function startCall() {
      localStream = await navigator.mediaDevices.getUserMedia({ video: true, audio: true });
      localVideo.srcObject = localStream;

      pc1 = new RTCPeerConnection(config);
      pc2 = new RTCPeerConnection(config);

      // Exchange ICE candidates
      pc1.onicecandidate = e => e.candidate && pc2.addIceCandidate(e.candidate);
      pc2.onicecandidate = e => e.candidate && pc1.addIceCandidate(e.candidate);

      // Receive stream
      pc2.ontrack = e => remoteVideo.srcObject = e.streams[0];

      // Send tracks from local stream
      localStream.getTracks().forEach(track => pc1.addTrack(track, localStream));

      const offer = await pc1.createOffer();
      await pc1.setLocalDescription(offer);
      await pc2.setRemoteDescription(offer);

      const answer = await pc2.createAnswer();
      await pc2.setLocalDescription(answer);
      await pc1.setRemoteDescription(answer);
    }

    function hangUp() {
      pc1?.close();
      pc2?.close();
      localVideo.srcObject = null;
      remoteVideo.srcObject = null;
    }

    startBtn.onclick = startCall;
    hangupBtn.onclick = hangUp;
  </script>
</body>
</html>
